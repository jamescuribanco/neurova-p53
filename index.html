<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Neurova P53 - Academia Premium</title>
  <style>
    body { margin:0; font-family:'Segoe UI', sans-serif; background:#f4f7f6; color:#1a202c; }
    header { background: linear-gradient(135deg, #0f172a, #1e40af); color: white; padding: 15px 40px; display: flex; align-items: center; justify-content: space-between; position: sticky; top:0; z-index:100; box-shadow: 0 2px 10px rgba(0,0,0,0.2); }
    nav a { color: white; margin-left: 20px; text-decoration: none; font-weight: 600; cursor: pointer; font-size: 14px; transition: 0.3s; }
    nav a:hover { color: #93c5fd; }
    .container { max-width: 1100px; margin: 30px auto; padding: 0 20px; }
    .card { background: white; border-radius: 15px; padding: 25px; box-shadow: 0 4px 15px rgba(0,0,0,0.05); margin-bottom: 20px; }
    .grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(280px, 1fr)); gap: 20px; }
    
    /* Botones */
    button { background: #2563eb; color: white; border: none; padding: 12px 18px; border-radius: 10px; cursor: pointer; font-weight: 600; transition: 0.3s; }
    button:hover { background: #1d4ed8; transform: translateY(-2px); }
    .btn-back { background: #64748b; margin-top: 20px; }
    
    /* Semanas */
    .semana-card { background: white; border: 1px solid #e2e8f0; border-radius: 12px; padding: 15px; margin-bottom: 10px; display: flex; flex-direction: column; gap: 10px; }
    .semana-header { display: flex; justify-content: space-between; align-items: center; border-bottom: 1px solid #f1f5f9; padding-bottom: 10px; }
    .tema-texto { font-size: 14px; color: #475569; line-height: 1.4; font-style: italic; }
    .recursos-row { display: flex; gap: 10px; flex-wrap: wrap; }
    .recursos-row button { padding: 8px 12px; font-size: 12px; background: #f1f5f9; color: #1e40af; border: 1px solid #cbd5e1; }
    .recursos-row button:hover { background: #e2e8f0; }

    .hidden { display: none; }
    .admin-panel { background: #fff7ed; border: 2px dashed #f97316; padding: 20px; border-radius: 15px; margin-bottom: 25px; }
    select, input { padding: 10px; border-radius: 8px; border: 1px solid #cbd5e1; margin-right: 10px; }
  </style>
</head>
<body>

<header>
  <div style="display:flex; align-items:center;">
    <img src="logo.jpeg" alt="Logo" style="height:45px; border-radius:50%; margin-right:12px;">
    <h1 style="font-size:20px; letter-spacing:1px;">NEUROVA P53</h1>
  </div>
  <nav>
    <a onclick="nav('inicio')">Inicio</a>
    <a onclick="nav('cursos-container')">Mis Cursos</a>
    <a id="admin-nav" class="hidden" onclick="nav('admin-panel')">Panel Admin</a>
  </nav>
</header>
<div id="inicio" class="container">
  <div class="card" style="text-align:center;">
    <h2 style="color:#1e40af;">Plataforma Educativa de Ciencias de la Salud</h2>
    <div id="login-area">
      <p>Accede con tu cuenta autorizada para ver tus cursos.</p>
      <button id="login-btn">Iniciar Sesi√≥n con Google</button>
    </div>
    <div id="user-info" class="hidden">
      <h3 id="welcome-user"></h3>
      <button onclick="logout()" style="background:#ef4444;">Cerrar Sesi√≥n</button>
    </div>
  </div>
</div>

<div id="cursos-container" class="container hidden">
  <h2 style="border-left: 5px solid #2563eb; padding-left: 15px;">Mis Cursos en curso</h2>
  <div id="lista-cursos" class="grid"></div>
</div>

<div id="submaterias-container" class="container hidden">
  <h2 id="titulo-curso-actual"></h2>
  <p>Selecciona una rama para ver el temario:</p>
  <div id="lista-submaterias" class="grid"></div>
  <button class="btn-back" onclick="nav('cursos-container')">‚Üê Volver a Cursos</button>
</div>

<div id="semanas-container" class="container hidden">
  <h2 id="titulo-submateria-actual"></h2>
  
  <div id="panel-editor-james" class="admin-panel hidden">
    <h3>üõ† Herramientas de James (Admin)</h3>
    <p>Sube materiales para esta materia:</p>
    <select id="select-semana">
      <option value="1">Semana 1</option><option value="2">Semana 2</option><option value="3">Semana 3</option><option value="4">Semana 4</option>
      <option value="5">Semana 5</option><option value="6">Semana 6</option><option value="7">Semana 7</option><option value="8">Semana 8</option>
    </select>
    <input type="text" id="input-url" placeholder="Pega el link de Drive/Zoom aqu√≠">
    <div style="margin-top:10px;">
      <button onclick="subirMaterial('pdf')" style="background:#10b981;">Subir PDF</button>
      <button onclick="subirMaterial('video')" style="background:#06b6d4;">Subir Grabaci√≥n</button>
      <button onclick="subirMaterial('banco')" style="background:#f59e0b;">Subir Banqueo</button>
    </div>
  </div>

  <div id="lista-semanas"></div>
  <button class="btn-back" onclick="nav('submaterias-container')">‚Üê Volver a Materias</button>
</div>

<div id="admin-panel" class="container hidden">
  <div class="card">
    <h2>Registro de Actividad</h2>
    <div id="log-actividad">Cargando datos...</div>
  </div>
</div>
<script type="module">
  import { initializeApp } from "https://www.gstatic.com/firebasejs/10.3.0/firebase-app.js";
  import { getAuth, GoogleAuthProvider, signInWithPopup, signOut, onAuthStateChanged } from "https://www.gstatic.com/firebasejs/10.3.0/firebase-auth.js";
  import { getFirestore, doc, setDoc, getDoc, collection, getDocs } from "https://www.gstatic.com/firebasejs/10.3.0/firebase-firestore.js";

  const firebaseConfig = {
    apiKey: "AIzaSyDAmEVU8J-uk2Yg6bL5n28xbP1771cHGME",
    authDomain: "neurovap53-cdbcf.firebaseapp.com",
    projectId: "neurovap53-cdbcf"
  };

  const app = initializeApp(firebaseConfig);
  const auth = getAuth();
  const db = getFirestore(app);
  const provider = new GoogleAuthProvider();

  // --- CONTENIDO DE LOS CURSOS ---
  const CURSOS_DB = {
    "Morfofisiolog√≠a 1": {
      "Fisiolog√≠a": [
        "Membrana celular, receptores, canales y potenciales.", "Se√±ales celulares, medio interno y l√≠quidos.", "Neurotransmisores y contracci√≥n muscular.", "Metabolismo √≥seo y Examen Parcial.",
        "Sangre, hematopoyesis y hemograma.", "Fisiolog√≠a eritrocitaria y hemostasia.", "Inmunidad innata y adquirida.", "Inflamaci√≥n y Examen Final."
      ],
      "Histolog√≠a": [
        "Procesamiento histol√≥gico y Embriolog√≠a esqueleto.", "Tejido √≥seo y origen muscular.", "Tejido muscular II y Tejido nervioso.", "Sistema vascular y Examen Parcial.",
        "Epitelio de revestimiento y glandular.", "Tejido conectivo, adiposo y sangu√≠neo.", "Tejido linfoide y √≥rganos linfoides.", "Sistema tegumentario y Examen Final."
      ]
    },
    "Morfofisiolog√≠a 2": {
      "Anatom√≠a": [
        "Pared tor√°cica y regi√≥n mamaria.", "Mediastino superior y pericardio.", "Morfolog√≠a interna cardiaca.", "Mediastino posterior y Parcial.",
        "Pulmones y segmentaci√≥n.", "Columna dorsal y m√∫sculos.", "Ri√±√≥n y v√≠as urinarias.", "Radioanatom√≠a renal y Final."
      ],
      "Fisiolog√≠a": [
        "Hemodinamia y electrofisiolog√≠a.", "Ciclo cardiaco y EKG.", "Presi√≥n arterial y gasto cardiaco.", "Mec√°nica respiratoria y Parcial.",
        "Intercambio gaseoso y transporte O2.", "Estructura renal y filtraci√≥n.", "Equilibrio √°cido-base.", "Fisiolog√≠a aviaci√≥n y buceo y Final."
      ],
      "Histolog√≠a y Embriolog√≠a": [
        "Embriolog√≠a cardio e histolog√≠a coraz√≥n.", "Histolog√≠a vascular.", "Integraci√≥n embrio-histo cardiaca.", "Histolog√≠a vascular y Parcial.",
        "Embrio-histo respiratorio.", "Embrio-histo urinario.", "Histolog√≠a vejiga y uretra.", "Histopatolog√≠a renal y Final."
      ]
    },
    "Bioqu√≠mica": { "Teor√≠a": Array(8).fill("Temario de Teor√≠a"), "Laboratorio": Array(8).fill("Temario de Laboratorio") },
    "Biolog√≠a Celular": { "Teor√≠a": Array(8).fill("Temario de Teor√≠a"), "Laboratorio": Array(8).fill("Temario de Laboratorio") },
    "Anatom√≠a General": { "Anatom√≠a": Array(8).fill("Contenido General") }
  };

  let selCurso = ""; let selSub = "";
  const ADMIN = "jamesucribanco333@gmail.com";

  window.nav = (id) => {
    ['inicio', 'cursos-container', 'submaterias-container', 'semanas-container', 'admin-panel'].forEach(s => document.getElementById(s).classList.add('hidden'));
    document.getElementById(id).classList.remove('hidden');
  };

  function renderCursos() {
    const cont = document.getElementById('lista-cursos');
    cont.innerHTML = "";
    Object.keys(CURSOS_DB).forEach(c => {
      cont.innerHTML += `<div class="card"><h3>${c}</h3><button onclick="verSub('${c}')">Ver Materias</button></div>`;
    });
  }

  window.verSub = (c) => {
    selCurso = c;
    document.getElementById('titulo-curso-actual').innerText = c;
    const cont = document.getElementById('lista-submaterias');
    cont.innerHTML = "";
    Object.keys(CURSOS_DB[c]).forEach(sub => {
      cont.innerHTML += `<div class="card" style="border-left:8px solid #1e40af"><h3>${sub}</h3><button onclick="verSemanas('${sub}')">Entrar</button></div>`;
    });
    nav('submaterias-container');
  };

  window.verSemanas = async (sub) => {
    selSub = sub;
    document.getElementById('titulo-submateria-actual').innerText = `${selCurso} > ${sub}`;
    const cont = document.getElementById('lista-semanas');
    cont.innerHTML = "Cargando temario...";
    nav('semanas-container');

    if(auth.currentUser?.email === ADMIN) document.getElementById('panel-editor-james').classList.remove('hidden');

    let html = "";
    const temas = CURSOS_DB[selCurso][sub];
    
    for(let i=0; i<8; i++) {
      const idDoc = `${selCurso}_${sub}_S${i+1}`;
      const snap = await getDoc(doc(db, "recursos", idDoc));
      const r = snap.exists() ? snap.data() : {};

      html += `
        <div class="semana-card">
          <div class="semana-header">
            <strong>Semana ${i+1}</strong>
          </div>
          <div class="tema-texto">${temas[i] || "Tema por definir"}</div>
          <div class="recursos-row">
            <button onclick="window.open('${r.pdf || '#'}')">üìÑ PDF</button>
            <button onclick="window.open('${r.video || '#'}')">üé¨ Grabaci√≥n</button>
            <button onclick="window.open('${r.banco || '#'}')">‚úçÔ∏è Banqueo</button>
          </div>
        </div>`;
    }
    cont.innerHTML = html;
  };

  window.subirMaterial = async (tipo) => {
    const s = document.getElementById('select-semana').value;
    const url = document.getElementById('input-url').value;
    if(!url) return alert("Pega un link");
    await setDoc(doc(db, "recursos", `${selCurso}_${selSub}_S${s}`), { [tipo]: url }, { merge: true });
    alert("Material cargado con √©xito.");
    verSemanas(selSub);
  };

  document.getElementById('login-btn').onclick = () => signInWithPopup(auth, provider);
  window.logout = () => signOut(auth);

  onAuthStateChanged(auth, (user) => {
    if (user) {
      document.getElementById('login-area').classList.add('hidden');
      document.getElementById('user-info').classList.remove('hidden');
      document.getElementById('welcome-user').innerText = `Bienvenido, ${user.displayName}`;
      if(user.email === ADMIN) document.getElementById('admin-nav').classList.remove('hidden');
      renderCursos();
      nav('cursos-container');
    } else {
      document.getElementById('login-area').classList.remove('hidden');
      document.getElementById('user-info').classList.add('hidden');
      nav('inicio');
    }
  });
</script>
</body>
</html>
